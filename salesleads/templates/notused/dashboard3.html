{% extends 'salesleads/base.html' %}
{% load leaflet_tags %}
{% leaflet_js %}
{% leaflet_css %}
{% block title %}Dashboard{% endblock %}
{% block content %}
    <main role="main" class="container" style="margin-top: 15px;">
        <div class="row">
            <div class="col-md-12">
                <div class="card card-body ">
                    <a class="btn btn-outline-dark btn-lg btn-block" data-toggle="collapse" href="#pierwszezamowienia">Podsumowanie
                        lead'ow</a>
                    <div class="collapse show" id="pierwszezamowienia">
                        <div class="col-md-12" style="margin-top: 15px;">
                            <form method="GET" action="">
                                <div class="btn-group" role="group" aria-label="Basic example">
                                <button type="submit" name="this_week" class="btn btn-group-sm btn-outline-primary" value="True">Tydzień
                                </button>
                                <button type="submit" name="this_month" class="btn btn-group-sm btn-outline-primary" value="True">Miesiąc
                                </button>
                                <button type="submit" name="this_quarter" class="btn btn-group-sm btn-outline-primary" value="True">Kwartał
                                </button>
                                <button type="submit" name="this_year" class="btn btn-group-sm btn-outline-primary" value="True">2020</button>
                                <button type="submit" name="last_year" class="btn btn-group-sm btn-outline-primary" value="True">2019</button>
                                </div>
                            </form>
                        </div>
                    <div class="card-body">

                        <div class="row">
                            <div class="col-md-2 offset-md-1">
                                <div class="card text-white bg-success mb-3" style="max-width: 18rem;">
                                    <div class="card-header">Pierwsze zamówienie</div>
                                    <div class="card-body">
                                        <h3 class="card-title">{{ status_one }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="card text-white bg-warning mb-3" style="max-width: 18rem;">
                                    <div class="card-header">Złożone warunki/oferta</div>
                                    <div class="card-body">
                                        <h3 class="card-title">{{ status_two }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="card text-white bg-primary mb-3" style="max-width: 18rem;">
                                    <div class="card-header">Najbardziej obiecujące</div>
                                    <div class="card-body">
                                        <h3 class="card-title">{{ status_three }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="card text-white bg-secondary mb-3" style="max-width: 18rem;">
                                    <div class="card-header">Pozostałe aktywności</div>
                                    <div class="card-body">
                                        <h3 class="card-title">{{ status_four }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="card text-white bg-danger mb-3" style="max-width: 18rem;">
                                    <div class="card-header">Odrzucone leady</div>
                                    <div class="card-body">
                                        <h3 class="card-title">{{ status_five }}</h3>
                                    </div>
                                </div>
                            </div>


                        </div>

                    </div>
                </div>
            </div>
        </div>
    </main>

            <main role="main" class="container" style="margin-top: 15px;">
                <div class="tab-content" id="pills-tabContent">
                    <div class="tab-pane fade show active" id="pills-home" role="tabpanel"
                         aria-labelledby="pills-home-tab">

                        <div class="col-md-12">
                            <div class="card bg-light mb-3">
                                <div class="card-header">Podsumowanie lead'ow
                                    <form method="GET" action="">
                                        <button type="submit" name="this_week" class="btn btn-light" value="True">
                                            Tydzień
                                        </button>
                                        <button type="submit" name="this_month" class="btn btn-light" value="True">
                                            Miesiąc
                                        </button>
                                        <button type="submit" name="this_quarter" class="btn btn-light" value="True">
                                            Kwartał
                                        </button>
                                        <button type="submit" name="this_year" class="btn btn-light" value="True">2020
                                        </button>
                                        <button type="submit" name="last_year" class="btn btn-light" value="True">2019
                                        </button>
                                    </form>
                                </div>

                                <div class="card-body">
                                    <p class="card-text">
                                    <div class="row">
                                        <div class="col-md-2 offset-md-1">
                                            <div class="card text-white bg-success mb-3" style="max-width: 18rem;">
                                                <div class="card-header">Pierwsze zamówienie</div>
                                                <div class="card-body">
                                                    <h3 class="card-title">{{ status_one }}</h3>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="card text-white bg-warning mb-3" style="max-width: 18rem;">
                                                <div class="card-header">Złożone warunki/oferta</div>
                                                <div class="card-body">
                                                    <h3 class="card-title">{{ status_two }}</h3>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="card text-white bg-primary mb-3" style="max-width: 18rem;">
                                                <div class="card-header">Najbardziej obiecujące</div>
                                                <div class="card-body">
                                                    <h3 class="card-title">{{ status_three }}</h3>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="card text-white bg-secondary mb-3" style="max-width: 18rem;">
                                                <div class="card-header">Pozostałe aktywności</div>
                                                <div class="card-body">
                                                    <h3 class="card-title">{{ status_four }}</h3>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="card text-white bg-danger mb-3" style="max-width: 18rem;">
                                                <div class="card-header">Odrzucone leady</div>
                                                <div class="card-body">
                                                    <h3 class="card-title">{{ status_five }}</h3>
                                                </div>
                                            </div>
                                        </div>


                                    </div>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content" id="pills-tabContent">
                        <div class="tab-pane fade show active" id="pills-home" role="tabpanel"
                             aria-labelledby="pills-home-tab">
                            <div class="col-md-12">
                                <div class="card bg-light mb-3">
                                    <div class="card-header">Lista zaplanowanych działań
                                        <form method="GET" action="">
                                            <button type="submit" name="todo" class="btn btn-light" value="True">
                                                Zaplanowane
                                            </button>
                                            <button type="submit" name="done" class="btn btn-light" value="True">
                                                Wykonane
                                            </button>
                                            <button type="submit" name="overdue" class="btn btn-light" value="True">
                                                Przeterminowane
                                            </button>
                                        </form>
                                    </div>
                                    <div class="card-body">

                                        <p class="card-text">
                                        <table class="table table-sm table-hover">
                                            <tr>
                                                <th style="width: 20%">Data</th>
                                                <th style="width: 20%">Nazwa firmy</th>
                                                <th style="width: 20%">Typ</th>
                                                <th style="width: 30%">Komentarz</th>
                                                <th style="width: 5%"></th>
                                                <th style="width: 5%"></th>

                                            </tr>
                                            {% for activity in page_obj %}
                                                <tr>
                                                    <td>{{ activity.date|date:"d E Y" }}</td>
                                                    <td>{{ activity.saleslead.company_name }}</td>
                                                    <td>{{ activity.get_activity_type_display }}</td>
                                                    <td>{{ activity.activity_comment }}</td>
                                                    <td><a class="btn btn-sm btn-light"
                                                           href="{% url 'plannedactivity-update' activity.id %}">Edytuj</a>
                                                    </td>
                                                    <td><a class="btn btn-sm btn-dark"
                                                           onclick="return confirm('Czy na pewno chcesz usunąć?')"
                                                           href=""><i class="fas fa-check-circle"></i></a></td>
                                                </tr>
                                            {% endfor %}
                                        </table>
                                        </p>
                                        <nav aria-label="...">
                                            <ul class="pagination justify-content-center">
                                                {% if page_obj.has_previous %}
                                                    <li class="page-item bg">
                                                        <a class="page-link"
                                                           href="?todo={{ todo }}&done={{ done }}&overdue={{ overdue }}&page={{ page_obj.previous_page_number }}"
                                                           tabindex="-1">Poprzednia</a>
                                                    </li>
                                                    <li class="page-item"><a class="page-link"
                                                                             href="?todo={{ todo }}&done={{ done }}&overdue={{ overdue }}&page={{ page_obj.previous_page_number }}">{{ page_obj.previous_page_number }}</a>
                                                    </li>
                                                {% else %}
                                                    <li class="page-item disabled">
                                                        <a class="page-link" href="" tabindex="-1">Poprzednia</a>
                                                    </li>
                                                {% endif %}
                                                <li class="page-item active">
                                                    <a class="page-link" href="#">{{ page_obj.number }} <span
                                                            class="sr-only">(current)</span></a>
                                                </li>
                                                {% if page_obj.has_next %}
                                                    <li class="page-item"><a class="page-link"
                                                                             href="?todo={{ todo }}&done={{ done }}&overdue={{ overdue }}&page=={{ page_obj.next_page_number }}">{{ page_obj.next_page_number }}</a>
                                                    </li>
                                                    <li class="page-item">
                                                        <a class="page-link"
                                                           href="?todo={{ todo }}&done={{ done }}&overdue={{ overdue }}&page={{ page_obj.next_page_number }}">Następna</a>
                                                    </li>
                                                {% else %}
                                                    <li class="page-item disabled">
                                                        <a class="page-link" href="">Następna</a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                        </nav>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-content" id="pills-tabContent">
                        <div class="tab-pane fade show active" id="pills-home" role="tabpanel"
                             aria-labelledby="pills-home-tab">
                            <div class="col-md-12">
                                <div class="card bg-light mb-3">
                                    <div class="card-body">
                                        <h5 class="card-title">Lista ostatnich 10 aktywności</h5>
                                        <p class="card-text">
                                        <table class="table table-sm table-hover">
                                            <tr>
                                                <th style="width: 20%">Data</th>
                                                <th style="width: 20%">Lead</th>
                                                <th style="width: 20%">Akcja</th>
                                                <th style="width: 20%">Typ</th>
                                            </tr>
                                            {% for t in together|slice:":10" %}
                                                <td>{{ t.0 }}</td>
                                                <td>{{ t.1 }}</td>
                                                <td>{{ t.2 }}</td>
                                                {% if t.6 == 'comment' %}
                                                    {% if t.2 != 'Usunięte' and t.1 != None %}
                                                        <td><a href="{% url 'comment-update' t.5 %}">{{ t.3 }}</a></td>
                                                    {% else %}
                                                        <td>{{ t.3 }}</td>
                                                    {% endif %}
                                                {% elif t.6 == 'contactperson' %}
                                                    {% if t.2 != 'Usunięte' and t.1 != None %}
                                                        <td><a href="{% url 'contactperson-update' t.5 %}">{{ t.3 }}</a>
                                                        </td>
                                                    {% else %}
                                                        <td>{{ t.3 }}</td>
                                                    {% endif %}
                                                {% elif t.6 == 'plannedactivity' %}
                                                    {% if t.2 != 'Usunięte' and t.1 != None %}
                                                        <td>
                                                            <a href="{% url 'plannedactivity-update' t.5 %}">{{ t.3 }}</a>
                                                        </td>
                                                    {% else %}
                                                        <td>{{ t.3 }}</td>
                                                    {% endif %}
                                                {% elif t.6 == 'saleslead' %}
                                                    {% if t.2 != 'Usunięte' and t.1 != None %}
                                                        <td><a href="{% url 'saleslead-detail' t.5 %}">{{ t.3 }}</a>
                                                        </td>
                                                    {% else %}
                                                        <td>{{ t.3 }}</td>
                                                    {% endif %}
                                                {% endif %}
                                                </tr>
                                            {% endfor %}
                                        </table>
                                        </p>
                                    </div>


                                </div>


                            </div>


                        </div>
                        <div class="tab-pane fade" id="pills-profile" role="tabpanel"
                             aria-labelledby="pills-profile-tab">...
                        </div>
                        <div class="tab-pane fade" id="pills-contact" role="tabpanel"
                             aria-labelledby="pills-contact-tab">...
                        </div>
                    </div>
                </div>
            </main>

            {% include 'salesleads/footer_sticky.html' %}
{% endblock %}